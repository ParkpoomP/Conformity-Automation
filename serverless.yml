service: auto-remediate

provider:
  name: aws
  runtime: nodejs8.10
  stage: v1
  region: ${opt:region, 'ca-central-1'}
  timeout: 10 # optional, in seconds, default is 6
  stackTags:
    service: auto-remediate
  deploymentBucket:
    serverSideEncryption: AES256

package:
  individually: true
  exclude:
   - "node_modules/**"

plugins:
  - serverless-plugin-additional-stacks

functions:

  AutoRemediateOrchestrator:
    handler: functions/AutoRemediateOrchestrator.handler
    timeout: 10
    memorySize: 128
    events:
      - sns:
          topicName: CloudConformity
          displayName: CloudConformity topic
    tags:
      Name: Auto Remediate Orchestrator
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateOrchestrator.js
    role: AutoRemediateOrchestratorRole

  AutoRemediateAG-005:
    handler: functions/AutoRemediateAG-005.handler
    memorySize: 128
    tags:
      Name: Auto Remediate AG-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateAG-005.js
    role: AutoRemediateAGRole

  AutoRemediateLambda-002:
    handler: functions/AutoRemediateLambda-002.handler
    memorySize: 128
    tags:
      Name: Auto Remediate Lambda-002
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateLambda-002.js
    role: AutoRemediateLambdaRole

  AutoRemediateS3-016:
    handler: functions/AutoRemediateS3-016.handler
    memorySize: 128
    tags:
      Name: Auto Remediate S3-016
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-016.js
    role: AutoRemediateS3Role

  AutoRemediateIAM-001:
    handler: functions/AutoRemediateIAM-001.handler
    memorySize: 128
    tags:
      Name: Auto Remediate IAM-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateIAM-001.js
    role: AutoRemediateIAM001Role

  AutoRemediateCT-001:
    handler: functions/AutoRemediateCT-001.handler
    memorySize: 128
    tags:
      Name: Auto Remediate CT-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateCT-001.js
    role: AutoRemediateCTRole

  AutoRemediateCT-002:
    handler: functions/AutoRemediateCT-002.handler
    memorySize: 128
    tags:
      Name: Auto Remediate CT-002
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateCT-002.js
    role: AutoRemediateCTRole

  AutoRemediateLambda-003:
    handler: functions/AutoRemediateLambda-003.handler
    memorySize: 128
    tags:
      Name: Auto Remediate Lambda-003
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateLambda-003.js
    role: AutoRemediateLambdaRole

  AutoRemediateLambda-004:
    handler: functions/AutoRemediateLambda-004.handler
    memorySize: 128
    tags:
      Name: Auto Remediate Lambda-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateLambda-004.js
    role: AutoRemediateLambdaRole
  
  AutoRemediateLambda-005:
    handler: functions/AutoRemediateLambda-005.handler
    memorySize: 128
    tags:
      Name: Auto Remediate Lambda-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateLambda-005.js
    role: AutoRemediateLambdaRole

  AutoRemediateS3-001:
    handler: functions/AutoRemediateS3-001.handler
    memorySize: 128
    tags:
      Name: Auto Remediate S3-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-001.js
    role: AutoRemediateS3Role

  AutoRemediateS3-002:
    handler: functions/AutoRemediateS3-002.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-002
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-002.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
    
    
  AutoRemediateIAM-038:
    handler: functions/AutoRemediateIAM-038.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate IAM-038
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateIAM-038.js
    role: AutoRemediateIAM038Role

  AutoRemediateS3-014:
    handler: functions/AutoRemediateS3-014.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-014
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-014.js
    role: AutoRemediateS3Role

  AutoRemediateS3-003:
    handler: functions/AutoRemediateS3-003.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-003
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-003.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
    
  AutoRemediateKMS-002:
    handler: functions/AutoRemediateKMS-002.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate KMS-002
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateKMS-002.js
    role: AutoRemediateKMS002Role
    
    

  AutoRemediateS3-004:
    handler: functions/AutoRemediateS3-004.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-004
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-004.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
   
      
  AutoRemediateRDS-023:
    handler: functions/AutoRemediateRDS-023.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate RDS-023
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateRDS-023.js
    role: AutoRemediateRDSRole      
      
  AutoRemediateGD-001:
    handler: functions/AutoRemediateGD-001.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate GD-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateGD-001.js
    role: AutoRemediateGD001Role
 
  AutoRemediateS3-005:
    handler: functions/AutoRemediateS3-005.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-005.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
    
  AutoRemediateS3-006:
    handler: functions/AutoRemediateS3-006.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-006
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-006.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
    
  AutoRemediateS3-007:
    handler: functions/AutoRemediateS3-007.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-007
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-007.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
    

  AutoRemediateKMS-004:
    handler: functions/AutoRemediateKMS-004.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate KMS-004
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateKMS-004.js
    role: AutoRemediateKMS004Role


  AutoRemediateOrganizations-002:
    handler: functions/AutoRemediateOrganizations-002.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate Organizations-002
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateOrganizations-002.js
    role: AutoRemediateOrganizations002Role
    
  AutoRemediateS3-008:
    handler: functions/AutoRemediateS3-008.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-008
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-008.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role
    
  AutoRemediateS3-009:
    handler: functions/AutoRemediateS3-009.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-009
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-009.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role

  AutoRemediateCT-003:
    handler: functions/AutoRemediateCT-003.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate CT-003
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateCT-003.js
    role: AutoRemediateCT003Role

  AutoRemediateRDS-006:
    handler: functions/AutoRemediateRDS-006.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate RDS-006
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateRDS-006.js
    role: AutoRemediateRDSRole
        
  AutoRemediateS3-010:
    handler: functions/AutoRemediateS3-010.handler
    memorySize: 128
    timeout: 10
    tags:
      Name: Auto Remediate S3-010
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-010.js
        - utils/S3_utils.js
        - node_modules/lodash.isequal/**
    role: AutoRemediateS3Role

  AutoRemediateS3-012:
    handler: functions/AutoRemediateS3-012.handler
    memorySize: 128
    tags:
      Name: Auto Remediate S3-012
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateS3-012.js
    role: AutoRemediateS3Role

  AutoRemediateSQS-004:
    handler: functions/AutoRemediateSQS-004.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate SQS-004
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateSQS-004.js
    role: AutoRemediateSQS004Role
  AutoRemediateRDS-008:
    handler: functions/AutoRemediateRDS-008.handler
    memorySize: 128
    tags:
      Name: Auto Remediate RDS-008
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateRDS-008.js
    role: AutoRemediateRDSRole

  AutoRemediateConfig-001:
    handler: functions/AutoRemediateConfig-001.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate Config-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateConfig-001.js
    role: AutoRemediateConfig001Role

  AutoRemediateCFM-005:
    handler: functions/AutoRemediateCFM-005.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate CFM-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateCFM-005.js
    role: AutoRemediateCFM005Role

  AutoRemediateVPC-001:
    handler: functions/AutoRemediateVPC-001.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate VPC-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateVPC-001.js
    role: AutoRemediateVPC001Role
  
  AutoRemediateEBS-009:
    handler: functions/AutoRemediateEBS-009.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EBS-009
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEBS-009.js
    role: AutoRemediateEBS009Role
        
      
  AutoRemediateRS-001:
    handler: functions/AutoRemediateRS-001.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate RS-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateRS-001.js
    role: AutoRemediateRS001Role

  AutoRemediateEC2-002:
    handler: functions/AutoRemediateEC2-002.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-002
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-002.js
    role: AutoRemediateEC2Role 

  AutoRemediateRS-019:
    handler: functions/AutoRemediateRS-019.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate RS-019
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateRS-019.js
    role: AutoRemediateRS019Role
    
  AutoRemediateEC2-003:
    handler: functions/AutoRemediateEC2-003.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-003
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-003.js
    role: AutoRemediateEC2Role

  AutoRemediateEC2-005:
    handler: functions/AutoRemediateEC2-005.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-005.js
    role: AutoRemediateEC2Role
    
  AutoRemediateEC2-019:
    handler: functions/AutoRemediateEC2-019.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-019
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-019.js
    role: AutoRemediateEC2Role

  AutoRemediateEC2-004:
    handler: functions/AutoRemediateEC2-004.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-004
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-004.js
    role: AutoRemediateEC2Role

  AutoRemediateEC2-006:
    handler: functions/AutoRemediateEC2-006.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-006
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-006.js
    role: AutoRemediateEC2Role
  
  AutoRemediateEC2-008:
    handler: functions/AutoRemediateEC2-008.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-008
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-008.js
    role: AutoRemediateEC2Role
    
  AutoRemediateEC2-043:
    handler: functions/AutoRemediateEC2-043.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-043
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-043.js
    role: AutoRemediateEC2Role
      
  AutoRemediateRS-023:
    handler: functions/AutoRemediateRS-023.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate RS-023
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateRS-023.js
    role: AutoRemediateRS023Role
    
    
  AutoRemediateEC2-045:
    handler: functions/AutoRemediateEC2-045.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-045
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-045.js
    role: AutoRemediateEC2Role
    
  AutoRemediateEC2-038:
    handler: functions/AutoRemediateEC2-038.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-038
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-038.js
    role: AutoRemediateEC2Role

  AutoRemediateEC2-040:
    handler: functions/AutoRemediateEC2-040.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-040
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-040.js
    role: AutoRemediateEC2Role
    
  AutoRemediateEC2-039:
    handler: functions/AutoRemediateEC2-039.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate EC2-039
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateEC2-039.js
    role: AutoRemediateEC2Role
    
  TrustedAdvisor-003:
    handler: functions/AutoRemediateTrustedAdvisor-003.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate TrustedAdvisor-003
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateTrustedAdvisor-003.js
    role: AutoRemediateTrustedAdvisor003Role

  AutoRemediateKinesis-001:
    handler: functions/AutoRemediateKinesis-001.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate Kinesis-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateKinesis-001.js
    role: AutoRemediateKinesis001Role

  AutoRemediateSNS-001:
    handler: functions/AutoRemediateSNS-001.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate SNS-001
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateSNS-001.js
    role: AutoRemediateSNSRole

  AutoRemediateSNS-004:
    handler: functions/AutoRemediateSNS-004.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate SNS-004
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateSNS-004.js
    role: AutoRemediateSNSRole
  
  AutoRemediateSNS-005:
    handler: functions/AutoRemediateSNS-005.handler
    timeout: 120
    memorySize: 128
    tags:
      Name: Auto Remediate SNS-005
      Owner: CloudConformity
      Role: Auto Remediate
      Environment: Ops
    package:
      include:
        - functions/AutoRemediateSNS-005.js
    role: AutoRemediateSNSRole

resources:

  Resources:

    AutoRemediateS3Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateS3-Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateS3-Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - s3:GetBucketPolicy
                    - s3:PutBucketPolicy
                    - s3:GetBucketAcl
                    - s3:PutBucketAcl
                    - s3:PutBucketVersioning
                  Resource: "*"
                  
    AutoRemediateIAM001Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateIAM-001Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateIAM-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - iam:UpdateAccessKey
                  Resource: "*"  
                  
    AutoRemediateEC2042Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateEC2-042Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateEC2-042Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - ec2:RevokeSecurityGroupIngress
                  Resource: "*"  

    AutoRemediateRS001Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateRS-001Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateRS-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - redshift:ModifyCluster
                  Resource: "*"

    AutoRemediateKMS002Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateKMS-002Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateKMS-002Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - kms:EnableKeyRotation
                  Resource: "*"

    AutoRemediateCFM005Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateCFM-005Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateCFM-005Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - cloudformation:UpdateTerminationProtection
                  Resource: "*"

    AutoRemediateRS019Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateRS-019Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateRS-019Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - redshift:ModifyCluster
                  Resource: "*"

    AutoRemediateConfig001Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateConfig-001Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateConfig-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - config:PutConfigurationRecorder
                    - config:PutDeliveryChannel
                    - config:StartConfigurationRecorder
                  Resource: "*"
                - Effect: Allow
                  Action:
                    - iam:AttachRolePolicy
                    - iam:CreateRole
                    - iam:GetRole
                    - iam:PassRole
                    - iam:PutRolePolicy
                  Resource: "*"
                - Effect: Allow
                  Action:
                    - sts:GetCallerIdentity
                  Resource: "*"

    AutoRemediateCTRole:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateCT-Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateCT-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - cloudtrail:UpdateTrail
                  Resource: "*"
                - Effect: Allow
                  Action:
                    - s3:GetBucketAcl
                    - s3:PutBucketAcl
                    - s3:PutBucketLogging
                    - cloudtrail:UpdateTrail
                  Resource: "*"

    AutoRemediateGD001Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateGD-001Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateGD-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - guardduty:CreateDetector
                    - iam:CreateServiceLinkedRole
                  Resource: "*"
                  
    AutoRemediateIAM038Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateIAM-038Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateIAM-038Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - iam:UpdateAccessKey
                  Resource: "*"

    AutoRemediateOrganizations002Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateOrganizations-002Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateOrganizations-002Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - organizations:EnableAllFeatures 
                  Resource: "*"

    AutoRemediateOrchestratorRole:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateOrchestratorRole
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateOrchestratorPolicy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - lambda:InvokeFunction
                  Resource: "*"
                  
    AutoRemediateEBS009Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateEBS-009Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateEBS-009Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - ec2:ModifySnapshotAttribute
                  Resource: "*"
                                        
    AutoRemediateVPC001Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateVPC-001Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateVPC-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - iam:AttachRolePolicy
                    - iam:CreateRole
                    - iam:GetRole
                    - iam:PassRole
                    - iam:PutRolePolicy
                  Resource: "*" 
                - Effect: Allow
                  Action:
                    - ec2:CreateFlowLogs
                  Resource: "*" 

    AutoRemediateRS023Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateRS-023Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateRS-023Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - redshift:ModifyClusterParameterGroup
                  Resource: "*"

    AutoRemediateRDSRole:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateRDS-Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateRDS-Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - rds:ModifyDBInstance
                    - rds:ModifyDBSnapshotAttribute
                  Resource: "*"

    AutoRemediateCT003Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateCT-003Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateCT-003Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - s3:PutBucketAcl
                  Resource: "*"

    AutoRemediateKMS004Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateKMS-004Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateKMS-004Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - kms:CancelKeyDeletion
                  Resource: "*"

    AutoRemediateTrustedAdvisor003Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateTrustedAdvisor-003Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateTrustedAdvisor-003Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - iam:UpdateAccessKey
                  Resource: "*"
                  
    AutoRemediateSQS004Role:  
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateSQS-004Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: SQS-004Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - "kms:ListKeys"
                    - "kms:ListAliases"
                    - "kms:DescribeKey"
                    - "sqs:SetQueueAttributes"
                  Resource: "*"

    AutoRemediateLambdaRole:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateLambda-Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - 
              Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
            -
              Effect: Allow
              Principal:
                AWS:
                  - Ref: 'AWS::AccountId'
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateLambda-Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - lambda:GetPolicy
                    - lambda:UpdateFunctionConfiguration
                    - lambda:GetFunctionConfiguration
                    - lambda:AddPermission
                    - lambda:RemovePermission
                    - lambda:UpdateFunctionConfiguration
                    - lambda:GetFunctionConfiguration
                    - lambda:GetPolicy
                    - iam:AttachRolePolicy
                  Resource: "*"
                - Effect: Allow
                  Action:
                    - sns:Publish
                  Resource: "*" 

    AutoRemediateAGRole:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateAG-Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - 
              Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
            -
              Effect: Allow
              Principal:
                AWS:
                  - Ref: 'AWS::AccountId'
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateAG-Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - apigateway:GET
                    - apigateway:UpdateRestApiPolicy
                  Resource: "*"
                - Effect: Allow
                  Action:
                    - ec2:DescribeVpcEndpoints
                  Resource: "*" 

    AutoRemediateKinesis001Role:  
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateKinesis-001Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: Kinesis-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - "kms:ListKeys"
                    - "kms:ListAliases"
                    - "kms:DescribeKey"
                    - "kinesis:StartStreamEncryption"
                  Resource: "*"

    AutoRemediateEC2Role:
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateEC2-Role
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: AutoRemediateEC2-Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - ec2:ModifyImageAttribute
                    - ec2:RevokeSecurityGroupIngress
                  Resource: "*"

    AutoRemediateSNSRole:  
      Type: AWS::IAM::Role
      Properties:
        RoleName: AutoRemediateSNSRole
        AssumeRolePolicyDocument:
          Version: '2012-10-17'
          Statement:
            - Effect: Allow
              Principal:
                Service:
                  - lambda.amazonaws.com
              Action:
                - sts:AssumeRole
        Policies:
          - PolicyName: Kinesis-001Policy
            PolicyDocument:
              Statement:
                - Effect: Allow
                  Action:
                    - logs:CreateLogGroup
                    - logs:CreateLogStream
                    - logs:PutLogEvents
                  Resource:
                    - 'Fn::Join':
                      - ':'
                      -
                        - 'arn:aws:logs'
                        - Ref: 'AWS::Region'
                        - Ref: 'AWS::AccountId'
                        - 'log-group:/aws/lambda/*:*:*'
                - Effect: Allow
                  Action:
                    - sns:GetTopicAttributes
                    - sns:RemovePermission
                  Resource:
                    - "*"

custom:
  additionalStacks:
    stackName:
      Deploy: Before
      DeployParameters:
        - ParameterKey: "SNSTopicName"
          ParameterValue: "email_lambda_autoremediate_alarm"
      StackName: "EmailSNS"
      Parameters:
        SNSTopicName:
          Type: String
          Default: "email_lambda_autoremediate_alarm"
          Description: "Name of the lambda to be created"
      Resources:
        SNSTopic:
          Type: AWS::SNS::Topic
          Properties:
            DisplayName: !Ref SNSTopicName
            TopicName: !Ref SNSTopicName