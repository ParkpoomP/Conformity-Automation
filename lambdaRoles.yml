AssumeRolePolicyDocument:
  Version: '2012-10-17'
  Statement:
    - Effect: Allow
      Principal:
        Service:
          - lambda.amazonaws.com
      Action: sts:AssumeRole

AutoRemediateVerifierPolicy:
  - PolicyName: AutoRemediateVerifierPolicy
    PolicyDocument:
      Statement:
        - Effect: Allow
          Action:
            - "ssm:GetParameter"
            - "ssm:GetParameterHistory"
            - "ssm:GetParameters"
            - "ssm:GetParametersByPath"
          Resource:
            - 'Fn::Join':
              - ':'
              -
                - 'arn:aws:ssm'
                - Ref: 'AWS::Region'
                - Ref: 'AWS::AccountId'
                - 'parameter/CLOUDCONFORMITY_API_KEY'
        - Effect: Allow
          Action:
            - sns:Publish
          Resource:
            - 'Fn::Join':
              - ':'
              -
                - 'arn:aws:sns'
                - Ref: 'AWS::Region'
                - Ref: 'AWS::AccountId'
                - 'CloudConformity'
        - Effect: Allow
          Action:
            - logs:CreateLogGroup
            - logs:CreateLogStream
            - logs:PutLogEvents
          Resource:
            - 'Fn::Join':
              - ':'
              -
                - 'arn:aws:logs'
                - Ref: 'AWS::Region'
                - Ref: 'AWS::AccountId'
                - 'log-group:/aws/lambda/*:*:*'
        - Effect: Allow
          Action:
            - lambda:InvokeFunction
          Resource: "*"
